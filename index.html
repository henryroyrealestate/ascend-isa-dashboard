<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ascend ISA Dashboard</title>
<style>
body{margin:0;font-family:"Inter",sans-serif;background:#f4f7fb;color:#1e2a36}.header{text-align:center;padding:30px 20px 20px;background:linear-gradient(180deg,#e7eef7 0%,#f5f8fc 100%);border-bottom:1px solid #d9e1ec}.logo{width:260px;margin-bottom:5px;margin-top:10px}h1{font-size:40px;margin:5px 0 5px;font-weight:700;color:#1f3549}.subtext{font-size:17px;color:#526578;margin-bottom:10px}.workhub{max-width:900px;margin:20px auto 40px;background:white;padding:30px;border-radius:20px;box-shadow:0 10px 28px rgba(0,0,0,0.12);border:1px solid #e3e8ef}.status-banner{display:none;background:#15384a;color:white;padding:12px;border-radius:10px;text-align:center;font-size:17px;font-weight:600;margin-bottom:12px}.error-banner{display:none;background:#b42d2d;color:white;padding:12px;border-radius:10px;text-align:center;font-size:16px;font-weight:600;margin-bottom:12px}.clocked-time{display:none;text-align:center;font-size:15px;color:#30475e;margin-bottom:20px;font-weight:600}.clock-btns{display:flex;gap:20px;justify-content:center;margin-bottom:20px}.clock-btn{flex:1;padding:14px;font-size:16px;border-radius:10px;border:none;font-weight:600;cursor:pointer;transition:0.2s;color:white}.clock-in{background:#15384a}.clock-in:hover{background:#1f4d67}.clock-out{background:#b02a2a}.clock-out:hover{background:#c03a3a}.disabled{opacity:0.35;cursor:not-allowed}.stats-box{text-align:center;font-size:17px;font-weight:600;margin-top:10px;color:#2f3f50}.secondary{font-size:14px;color:#556475;margin-top:5px;font-weight:500}.progress-bar-bg{width:100%;background:#e6edf5;height:18px;border-radius:10px;margin-top:15px;overflow:hidden}.progress-bar-fill{height:100%;width:0%;transition:width 0.4s ease}.green{background:#28a745}.yellow{background:#ffc107}.red{background:#dc3545}.agent-container{display:flex;justify-content:center;gap:30px;padding:0 20px;margin-bottom:50px;flex-wrap:wrap}.agent-card{background:white;border-radius:18px;width:290px;padding:26px;box-shadow:0 8px 22px rgba(0,0,0,0.08);text-align:center}.agent-card h2{margin-top:0;font-size:22px;font-weight:700}.btn{display:block;margin:10px auto;background:#2b4a5a;color:white;border:none;width:100%;padding:12px;border-radius:10px;font-size:15px;cursor:pointer;font-weight:600}.btn:hover{background:#3b6173}.assignment-card{max-width:900px;margin:0 auto 50px;background:white;padding:30px;border-radius:18px;box-shadow:0 8px 22px rgba(0,0,0,0.10)}.assignment-card h2{font-size:26px;margin-bottom:10px;font-weight:700;text-align:center;color:#15384a}.next-up-box{background:#e9f1f6;padding:14px;border-left:6px solid #15384a;border-radius:10px;margin-bottom:20px;font-size:17px;font-weight:600;color:#1b2e41}.assignment-form{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-top:15px}.assignment-form input,.assignment-form textarea,.assignment-form select{padding:12px;border-radius:10px;border:1px solid #c9d3df;font-size:15px}.assignment-form textarea{grid-column:span 2;min-height:80px}.assign-btn{grid-column:span 2;padding:14px;font-size:17px;background:#15384a;color:white;border:none;border-radius:12px;cursor:pointer;font-weight:700}.assign-btn:hover{background:#1f4d67}.generator-card{background:#ffffff;padding:30px;border-radius:14px;box-shadow:0 4px 20px rgba(0,0,0,0.08);margin:0 auto 60px;max-width:900px}.generator-card h2{text-align:center;margin-bottom:25px;font-size:26px;font-weight:700;color:#1d2d44}.generator-row{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;margin-bottom:30px}.gen-btn{background-color:#1d4e89;border:none;color:white;padding:12px 22px;font-size:16px;border-radius:10px;cursor:pointer;transition:0.15s}.gen-btn:hover{background-color:#163d6b}select{padding:10px;border-radius:8px;border:1px solid #ccc;font-size:16px}.output-box{background:#f8fafc;border-left:5px solid #1d4e89;padding:20px;border-radius:12px;min-height:150px;white-space:pre-wrap;font-size:15px;line-height:1.5}.call-activity{max-width:900px;margin:0 auto 40px;background:white;padding:20px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.08);border:1px solid #e3e8ef}.call-activity h3{text-align:center;font-size:18px;margin:0 0 15px 0;color:#15384a;font-weight:600}.call-periods{display:grid;grid-template-columns:repeat(4,1fr);gap:15px;margin-bottom:15px}.period-box{background:#f8fafc;padding:12px;border-radius:8px;text-align:center;border:1px solid #e3e8ef}.period-label{font-size:11px;color:#526578;margin-bottom:8px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}.period-stats{font-size:12px;color:#15384a;line-height:1.6}.period-stats div{margin:3px 0}.stat-number{font-weight:700;font-size:16px}.last-updated-compact{text-align:center;font-size:11px;color:#6c757d;font-style:italic}
</style>
</head>
<body>
<div class="header">
<img src="Ascend_Horiz_Logo.png" class="logo">
<h1>Hi, Kevin</h1>
<div class="subtext">Every dial is a doorway to an opportunity.</div>
</div>
<div class="workhub">
<div id="statusBanner" class="status-banner">YOU ARE CLOCKED IN</div>
<div id="errorBanner" class="error-banner"></div>
<div id="clockedTime" class="clocked-time"></div>
<div class="clock-btns">
<button id="clockInBtn" class="clock-btn clock-in">Clock In</button>
<button id="clockOutBtn" class="clock-btn clock-out disabled" disabled>Clock Out</button>
</div>
<div class="stats-box">
<div id="hoursToday">Today's Hours: 0.00</div>
<div id="weekHours" class="secondary">This Week: 0.00 / 20 hrs</div>
<div id="remainingHours" class="secondary"></div>
</div>
<div class="progress-bar-bg">
<div class="progress-bar-fill" id="weeklyProgress"></div>
</div>
</div>
<div class="agent-container">
<div class="agent-card">
<h2>Mike Frybarger</h2>
<a href="https://calendly.com/mike-frybarger/" target="_blank"><button class="btn">Schedule w/ Mike </button></a>
<a href="https://get.homebot.ai/?id=94538186-671b-4c01-8585-0ecc37898dbd" target="_blank"><button class="btn">Homebot Seller</button></a>
</div>
<div class="agent-card">
<h2>Henry Ulrich</h2>
<a href="https://calendly.com/henryroy" target="_blank"><button class="btn">Schedule w/ Henry</button></a>
<a href="https://hmbt.co/fUNkbh" target="_blank"><button class="btn">Homebot Seller</button></a>
</div>
<div class="agent-card">
<h2>Megan Dickerson</h2>
<a href="https://calendly.com/megandickerson-realestate" target="_blank"><button class="btn">Schedule w/ Megan</button></a>
<a href="https://get.homebot.ai/?id=14257442-1eec-49ec-b010-21fb01435f4b" target="_blank"><button class="btn">Homebot Seller</button></a>
</div>
</div>
<div class="assignment-card">
<h2>Appointment + Homebot Assignment</h2>
<div id="nextUpBox" class="next-up-box">Loading next agent...</div>
<div class="assignment-form">
<select id="assignType">
<option value="Appointment">Appointment</option>
<option value="Homebot">Homebot Signup</option>
</select>
<input id="assignName" placeholder="Client Name">
<input id="assignEmail" placeholder="Client Email">
<input id="assignPhone" placeholder="Client Phone">
<input id="assignAddress" placeholder="Client Address">
<textarea id="assignNotes" placeholder="Notes..."></textarea>
<button class="assign-btn" onclick="submitAssignment()">Submit Assignment</button>
</div>
</div>
  <!-- Quick Links -->
<div style="
    max-width: 900px;
    margin: 30px auto;
    background: white;
    padding: 18px 22px;
    border-radius: 14px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    display: flex;
    gap: 22px;
    justify-content: center;
    flex-wrap: wrap;
    font-size: 16px;
">
    <a href="https://mail.google.com" target="_blank" style="text-decoration:none;color:#1d4e89;font-weight:600;">
        Gmail
    </a>

    <a href="https://batchleads.io" target="_blank" style="text-decoration:none;color:#1d4e89;font-weight:600;">
        BatchLeads
    </a>

    <a href="https://property.pennco.org/" target="_blank" style="text-decoration:none;color:#1d4e89;font-weight:600;">
        Pennington County Owner Search
    </a>

    <a href="https://findahomerapidcity.com" target="_blank" style="text-decoration:none;color:#1d4e89;font-weight:600;">
        FindAHomeRapidCity.com
    </a>

    <a href="https://BlackHillsSDHomesForSale.com" target="_blank" style="text-decoration:none;color:#1d4e89;font-weight:600;">
        BlackHillsSDHomesForSale.com
    </a>
</div>

<div class="generator-card">
<h2>ISA Script Generator</h2>
<div class="generator-row">
<button class="gen-btn" onclick="generateColdHooks()">Cold Call Intros</button>
<button class="gen-btn" onclick="generateWarmHooks()">Warm Buyer Follow-Up</button>
<select id="objectionSelect">
<option value="notSelling">"We're not selling."</option>
<option value="haveAgent">"We already have an agent."</option>
<option value="spring">"We're waiting until spring."</option>
<option value="justLooking">"Just browsing."</option>
<option value="notInterested">"Not interested."</option>
<option value="stopCalling">"Stop calling."</option>
<option value="rental">"We're keeping it as a rental."</option>
<option value="generic">General objections</option>
</select>
<button class="gen-btn" onclick="generateObjections()">Handle Objection</button>
</div>
<div id="output" class="output-box">Click a button to generate scriptsâ€¦</div>
</div>
<div class="call-activity">
<h3>ðŸ“ž Call Activity Stats</h3>
<div class="call-periods">
<div class="period-box">
<div class="period-label">Today</div>
<div class="period-stats">
<div>Answered: <span class="stat-number" id="todayAnswered">-</span></div>
<div>No Answer: <span class="stat-number" id="todayNotAnswered">-</span></div>
<div>Total: <span class="stat-number" id="todayTotal">-</span></div>
<div>Rate: <span class="stat-number" id="todayRate">-</span></div>
</div>
</div>
<div class="period-box">
<div class="period-label">This Week</div>
<div class="period-stats">
<div>Answered: <span class="stat-number" id="weekAnswered">-</span></div>
<div>No Answer: <span class="stat-number" id="weekNotAnswered">-</span></div>
<div>Total: <span class="stat-number" id="weekTotal">-</span></div>
<div>Rate: <span class="stat-number" id="weekRate">-</span></div>
</div>
</div>
<div class="period-box">
<div class="period-label">This Month</div>
<div class="period-stats">
<div>Answered: <span class="stat-number" id="monthAnswered">-</span></div>
<div>No Answer: <span class="stat-number" id="monthNotAnswered">-</span></div>
<div>Total: <span class="stat-number" id="monthTotal">-</span></div>
<div>Rate: <span class="stat-number" id="monthRate">-</span></div>
</div>
</div>
<div class="period-box">
<div class="period-label">All Time</div>
<div class="period-stats">
<div>Answered: <span class="stat-number" id="allAnswered">-</span></div>
<div>No Answer: <span class="stat-number" id="allNotAnswered">-</span></div>
<div>Total: <span class="stat-number" id="allTotal">-</span></div>
<div>Rate: <span class="stat-number" id="allRate">-</span></div>
</div>
</div>
</div>
<div class="last-updated-compact" id="lastUpdated">Loading call data...</div>
</div>
<script>
const API_URL="https://script.google.com/macros/s/AKfycbzT_pqfRq0Ox4KcBIUMN4LUR_36wDDsZEULOQit9eXSVS_JBEWppEOtux6Mvqnv28KU/exec";const ANSWERED_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTw9lYKnrYxkjM6iZN6AMgPedSNFwrbM-TKFaqtVKr51dgVimlsbjVkLPoN233e_xBOy6sOPpOWjdnd/pub?gid=0&single=true&output=csv";const NOT_ANSWERED_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTw9lYKnrYxkjM6iZN6AMgPedSNFwrbM-TKFaqtVKr51dgVimlsbjVkLPoN233e_xBOy6sOPpOWjdnd/pub?gid=127422851&single=true&output=csv";function parseCSV(text){const lines=text.trim().split('\n');if(lines.length<=1)return[];const headers=lines[0].split(',').map(h=>h.trim());const rows=[];for(let i=1;i<lines.length;i++){const values=lines[i].split(',');const row={};headers.forEach((header,index)=>{row[header]=values[index]?values[index].trim():''});rows.push(row)}return rows}function getDateBounds(){const now=new Date();const todayStart=new Date(now.getFullYear(),now.getMonth(),now.getDate());const weekStart=new Date(todayStart);weekStart.setDate(todayStart.getDate()-todayStart.getDay());const monthStart=new Date(now.getFullYear(),now.getMonth(),1);return{todayStart,weekStart,monthStart}}function parseTimestamp(timestampStr){const parts=timestampStr.split(' ')[0].split('/');if(parts.length===3){const month=parseInt(parts[0])-1;const day=parseInt(parts[1]);const year=parseInt(parts[2]);return new Date(year,month,day)}return null}function countCallsByPeriod(rows){const{todayStart,weekStart,monthStart}=getDateBounds();const stats={today:0,week:0,month:0,all:rows.length};rows.forEach(row=>{const timestamp=Object.values(row)[0]||'';const date=parseTimestamp(timestamp);if(!date)return;if(date>=todayStart)stats.today++;if(date>=weekStart)stats.week++;if(date>=monthStart)stats.month++});return stats}async function refreshCallStats(){try{const res=await fetch(API_URL+"?action=callStats");const data=await res.json();if(data.status==="error"){throw new Error(data.message)}const answeredText=data.answeredCSV;const notAnsweredText=data.notAnsweredCSV;const answeredRows=parseCSV(answeredText);const notAnsweredRows=parseCSV(notAnsweredText);const answeredStats=countCallsByPeriod(answeredRows);const notAnsweredStats=countCallsByPeriod(notAnsweredRows);document.getElementById('todayAnswered').textContent=answeredStats.today;document.getElementById('todayNotAnswered').textContent=notAnsweredStats.today;const todayTotal=answeredStats.today+notAnsweredStats.today;document.getElementById('todayTotal').textContent=todayTotal;document.getElementById('todayRate').textContent=todayTotal>0?((answeredStats.today/todayTotal)*100).toFixed(1)+'%':'0%';document.getElementById('weekAnswered').textContent=answeredStats.week;document.getElementById('weekNotAnswered').textContent=notAnsweredStats.week;const weekTotal=answeredStats.week+notAnsweredStats.week;document.getElementById('weekTotal').textContent=weekTotal;document.getElementById('weekRate').textContent=weekTotal>0?((answeredStats.week/weekTotal)*100).toFixed(1)+'%':'0%';document.getElementById('monthAnswered').textContent=answeredStats.month;document.getElementById('monthNotAnswered').textContent=notAnsweredStats.month;const monthTotal=answeredStats.month+notAnsweredStats.month;document.getElementById('monthTotal').textContent=monthTotal;document.getElementById('monthRate').textContent=monthTotal>0?((answeredStats.month/monthTotal)*100).toFixed(1)+'%':'0%';document.getElementById('allAnswered').textContent=answeredStats.all;document.getElementById('allNotAnswered').textContent=notAnsweredStats.all;const allTotal=answeredStats.all+notAnsweredStats.all;document.getElementById('allTotal').textContent=allTotal;document.getElementById('allRate').textContent=allTotal>0?((answeredStats.all/allTotal)*100).toFixed(1)+'%':'0%';const now=new Date();const timeStr=now.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'});document.getElementById('lastUpdated').textContent=`Last updated: ${timeStr}`}catch(err){console.error("Call tracking error:",err);document.getElementById('lastUpdated').textContent="Error loading call data"}}refreshCallStats();setInterval(refreshCallStats,30000);async function refreshClock(){try{const res=await fetch(API_URL+"?action=clockStatus");const data=await res.json();document.getElementById("hoursToday").innerText="Today's Hours: "+(data.todayHours||0).toFixed(2);document.getElementById("weekHours").innerText="This Week: "+(data.weekHours||0).toFixed(2)+" / 20 hrs";document.getElementById("remainingHours").innerText="Remaining This Week: "+(data.remainingHours||0).toFixed(2)+" hrs";let percent=Math.min((data.weekHours/20)*100,100);const bar=document.getElementById("weeklyProgress");bar.style.width=percent+"%";bar.classList.remove("green","yellow","red");if(percent<50)bar.classList.add("green");else if(percent<90)bar.classList.add("yellow");else bar.classList.add("red");const statusBanner=document.getElementById("statusBanner");const clockedTime=document.getElementById("clockedTime");const errorBanner=document.getElementById("errorBanner");errorBanner.style.display="none";if(data.isClockedIn){statusBanner.style.display="block";clockedTime.style.display="block";clockedTime.innerText="Clocked in";document.getElementById("clockInBtn").disabled=true;document.getElementById("clockInBtn").classList.add("disabled");document.getElementById("clockOutBtn").disabled=false;document.getElementById("clockOutBtn").classList.remove("disabled")}else{statusBanner.style.display="none";clockedTime.style.display="none";document.getElementById("clockOutBtn").disabled=true;document.getElementById("clockOutBtn").classList.add("disabled");document.getElementById("clockInBtn").disabled=false;document.getElementById("clockInBtn").classList.remove("disabled")}}catch(err){console.error("Clock refresh error:",err)}}document.getElementById("clockInBtn").onclick=async()=>{const res=await fetch(API_URL+"?action=clock&event=Clock+In",{method:"POST"});const data=await res.json();if(data.status==="error"){const banner=document.getElementById("errorBanner");banner.innerText=data.message;banner.style.display="block"}refreshClock()};document.getElementById("clockOutBtn").onclick=async()=>{await fetch(API_URL+"?action=clock&event=Clock+Out",{method:"POST"});refreshClock()};refreshClock();setInterval(refreshClock,15000);async function loadNextUp(){const res=await fetch(API_URL+"?action=roundrobin");const data=await res.json();document.getElementById("nextUpBox").innerText=`Next Appointment: ${data.Appointment}    |    Next Homebot: ${data.Homebot}`}async function refreshNextUp(){await loadNextUp()}refreshNextUp();setInterval(refreshNextUp,15000);async function submitAssignment(){const category=document.getElementById("assignType").value;const name=document.getElementById("assignName").value;const email=document.getElementById("assignEmail").value;const phone=document.getElementById("assignPhone").value;const address=document.getElementById("assignAddress").value;const notes=document.getElementById("assignNotes").value;const url=`${API_URL}?action=assign&category=${encodeURIComponent(category)}&name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}&phone=${encodeURIComponent(phone)}&address=${encodeURIComponent(address)}&notes=${encodeURIComponent(notes)}`;const res=await fetch(url,{method:"POST"});const data=await res.json();if(data.status==="success"){alert(`Assigned to ${data.assignedTo}`);document.getElementById("assignName").value="";document.getElementById("assignEmail").value="";document.getElementById("assignPhone").value="";document.getElementById("assignAddress").value="";document.getElementById("assignNotes").value="";await loadNextUp()}}function generateColdHooks(){const hooks=["Hey, this is Kevin with Ascend Realty. Quick question, would you be open to hearing how much buyers are paying in your neighborhood lately?","Kevin here with Ascend Realty. Do you follow the real estate activity around your street at all?","This is Kevin at Ascend Realty. If there was a strong shift in demand on your block, would that be something you'd want a heads-up on?","Kevin with Ascend Realty checking in. Are you familiar with what your home would realistically attract today?","If your equity jumped more than you expected, would you want to know? This is Kevin with Ascend Realty.","This is Kevin over at Ascend Realty. When's the last time someone gave you a true local update, not the Zillow nonsense?"];document.getElementById("output").textContent=hooks.map(h=>"â€¢ "+h).join("\n\n")}function generateWarmHooks(){const warm=["Hey, this is Kevin with Ascend Realty. I saw you checked out some homes on our site and wanted to see what caught your eye.","Kevin here at Ascend Realty. Were you browsing casually or actively looking for something in the next few months?","Saw you saved a property recently. What stood out about it to you?"];document.getElementById("output").textContent=warm.map(h=>"â€¢ "+h).join("\n\n")}function generateObjections(){const type=document.getElementById("objectionSelect").value;const responses={notSelling:["Totally fair. Most people I talk to aren't selling right now. I'm just giving quick market updates so you always know where you stand.","No problem at all. If the market shifted in your favor, would a quick update still be useful?","I completely understand. I'm not calling to pressure youâ€”just wanted to make sure you have the latest info if your plans ever change."],haveAgent:["That's awesome, sticking with someone you trust matters. When did they last update you on your home value?","Great to hear! Just curiousâ€”are they keeping you in the loop on what's happening in your neighborhood?","Perfect. If you ever need a second opinion or market update, I'm always happy to help."],spring:["That makes senseâ€”spring is usually a hot time. Have you thought about what you'd want to see in terms of price to make a move?","Smart move. A lot of sellers wait for spring. Want to know what we're seeing for homes like yours right now so you're prepared?","Totally get it. If buyers start showing up earlier than expected, would you want a heads-up?"],justLooking:["No worries at all. What kind of homes have you been checking out?","Gotcha. Are you looking in any specific neighborhoods or just exploring?","Makes sense. If something perfect pops up, would you want to know about it before it hits the market?"],notInterested:["No problemâ€”appreciate you letting me know. If things change down the line, feel free to reach out.","Understood. Just wanted to make sure you had the info in case your situation shifts.","Fair enough. I'll leave you alone, but if you ever need anything real estate related, we're here."],stopCalling:["Absolutely, I'll make sure you're removed from our list right away. Sorry for the inconvenience.","No problemâ€”I'll take you off our call list. Have a great day!","Done. I'll make sure this is your last call from us. Take care!"],rental:["Smart moveâ€”rental income can be great. Are you managing it yourself or using a property manager?","Nice! How's the rental market treating you? Getting good tenants?","That's a solid strategy. If you ever decide to sell or need help with anything, let me know."],generic:["I hear you. Can I askâ€”what's the biggest reason you're not interested right now?","Fair enough. Is it timing, or just not something you're thinking about at all?","Totally understand. Mind if I askâ€”if the situation were different, what would make you more open to chatting?"]};const selected=responses[type];if(selected){document.getElementById("output").textContent=selected.map(r=>"â€¢ "+r).join("\n\n")}else{document.getElementById("output").textContent="No responses found for this objection."}}
</script>
</body>
</html>

